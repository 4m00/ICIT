# Лабораторная работа №3 - Система управления университетом


## Часть 1 - Идентификация и аутентификация пользователей

### Выбранный метод
В проекте реализована идентификация и аутентификация пользователей на базе метода, использующего постоянные, многократно используемые пароли с дополнительными механизмами безопасности.

### Обоснование выбора
1. Надежность и проверенность метода
2. Расширенные возможности безопасности (блокировка после неудачных попыток, сброс пароля)
3. Возможность аудита действий пользователей
4. Интеграция с существующими системами университета

### Реализация
Система использует следующие механизмы:

1. **Идентификация пользователя**:
```sql
CREATE TABLE users (
    id int NOT NULL AUTO_INCREMENT,
    username varchar(50) NOT NULL,
    email varchar(100) NOT NULL,
    first_name varchar(50) NOT NULL,
    last_name varchar(50) NOT NULL,
    is_active tinyint(1) DEFAULT '1',
    failed_attempts int DEFAULT '0',
    last_failed_attempt timestamp NULL DEFAULT NULL,
    reset_code varchar(32) DEFAULT NULL,
    reset_code_expires timestamp NULL DEFAULT NULL,
    PRIMARY KEY (id),
    UNIQUE KEY username (username),
    UNIQUE KEY email (email)
)
```

2. **Аутентификация**:
- Хеширование паролей с использованием bcrypt
- Механизм блокировки после неудачных попыток входа
- Система восстановления пароля через email
- Журналирование всех попыток входа

3. **Безопасность сессий**:
```sql
CREATE TABLE sessions (
    id varchar(128) NOT NULL,
    user_id int DEFAULT NULL,
    ip_address varchar(45) DEFAULT NULL,
    user_agent text,
    payload text,
    last_activity timestamp NULL DEFAULT NULL
)
```

## Часть 2 - Авторизация пользователей

### Выбранный метод
В проекте реализован комбинированный подход к авторизации, сочетающий ролевую модель (RBAC) с элементами дискреционного управления доступом.

### Обоснование выбора
1. Гибкость в настройке прав доступа
2. Эффективное управление большим количеством пользователей
3. Поддержка иерархической структуры университета
4. Детальный контроль доступа к ресурсам

### Реализация
Система использует следующие таблицы для управления доступом:

1. **Роли пользователей**:
```sql
CREATE TABLE roles (
    id int NOT NULL,
    name varchar(50) NOT NULL,
    description text,
    created_at timestamp NULL DEFAULT CURRENT_TIMESTAMP
)

CREATE TABLE user_roles (
    user_id int NOT NULL,
    role_id int NOT NULL,
    role_type enum('primary','secondary') NOT NULL DEFAULT 'primary',
    created_at timestamp NULL DEFAULT CURRENT_TIMESTAMP
)
```

2. **Иерархия подразделений**:
```sql
CREATE TABLE departments (
    id int NOT NULL AUTO_INCREMENT,
    faculty_id int NOT NULL,
    name varchar(255) NOT NULL,
    head_user_id int DEFAULT NULL,
    PRIMARY KEY (id)
)
```

## Часть 3 - Ролевое управление

### Выбранный метод
В системе реализовано расширенное ролевое управление с поддержкой множественных ролей и иерархической структурой.

### Реализация
Система включает следующие основные роли:

1. **Администратор (admin)**:
- Полный доступ к системе
- Управление пользователями и ролями
- Системные настройки

2. **Сотрудник деканата (dekanat)**:
- Управление учебным процессом
- Работа с расписанием
- Контроль успеваемости

3. **Преподаватель (teacher)**:
```sql
CREATE TABLE teachers (
    id int NOT NULL AUTO_INCREMENT,
    user_id int NOT NULL,
    department_id int DEFAULT NULL,
    position varchar(50) NOT NULL,
    academic_degree varchar(50) DEFAULT NULL,
    PRIMARY KEY (id)
)
```

4. **Студент (student)**:
```sql
CREATE TABLE students (
    id int NOT NULL AUTO_INCREMENT,
    user_id int NOT NULL,
    student_id_number varchar(20) NOT NULL,
    current_semester int DEFAULT '1',
    status enum('active','inactive','graduated','academic_leave') NOT NULL DEFAULT 'active',
    PRIMARY KEY (id)
)
```

### Аудит действий пользователей

Система ведет подробный журнал действий:
```sql
CREATE TABLE activity_log (
    id int NOT NULL,
    user_id int DEFAULT NULL,
    action varchar(100) NOT NULL,
    entity_type varchar(50) NOT NULL,
    entity_id int DEFAULT NULL,
    details text,
    ip_address varchar(45) DEFAULT NULL,
    category enum('academic','administrative','system') NOT NULL,
    importance enum('low','medium','high') NOT NULL DEFAULT 'low',
    status enum('pending','completed','failed') NOT NULL DEFAULT 'completed',
    created_at timestamp NULL DEFAULT CURRENT_TIMESTAMP
)
```

## Заключение

Реализованная система обеспечивает:
1. Надежную многоуровневую защиту
2. Гибкое управление правами доступа
3. Детальное протоколирование действий
4. Масштабируемость и расширяемость

Система полностью соответствует современным требованиям безопасности и удобства использования в образовательных учреждениях. 